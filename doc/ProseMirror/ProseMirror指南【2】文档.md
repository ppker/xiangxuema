# 文档

ProseMirror 定义了自己的数据结构来表示文档内容。由于整个编辑器都是围绕文档构建的，所以了解文档的数据结构及工作原理是非常有价值的。

## 数据结构 Structure

一个 ProseMirror 的文档对象可以包含 0 个或多个子节点，这与 Html 的 Dom 对象非常相似，也是层级树状的。它与 Html 不同之处是：存储内联内容方式（inline content）。

比如下面这段 HTML 代码

```html
<p>
  This is <strong>strong text with <em>emphasis</em></strong>
</p>
```

它的数据表现形式为：

![](./img/htmlDoc.png)

在 ProseMirror 中，这些数据被被扁平的放在一个数据结构中，使用元数据来描述数据的形式：

![](./img/htmlDoc2.png)

这更接近于我们思考和处理这类文本的方式。它允许我们使用字符偏移量而不是树中的路径来表示段落中的位置，这样就更容易完成拆分或更改样式等操作，而无需执行笨拙的树操作。

这也意味着每个文档都有一个有效表示。具有相同标记集的相邻文本节点总是组合在一起，不允许空文本节点出现。schema 会决定标记出现的顺序。

所以 ProseMirror 文档对象的大部分叶子节点都是文本节点，而且叶子节点可能包含多个拥有不同样式的文本。您还可以有纯空的叶子节点，用于放置水平线或视频元素。

节点对象具有许多属性，这些属性反映了它们在文档中所扮演的角色:

- isBlock 和 isInline 告诉你给定的节点是块节点还是内联节点。
- inlineContent 值为 true 时，当前节点的子节点都是内联节点。
- isTextblock 为 true 时，当前块节点的子节点都是内联节点。
- isLeaf 标记着当前节点是否为叶子节点，叶子节点不允许再拥有子节点。

因此，一般`paragraph`节点将是一个文本块，而 `blockquote` 可能是一个块节点（可能会包含其他块节点），文本、换行符和内联图像都是内联叶子节点，水平线节点是一个块状叶子节点。
